# Простой Python Веб-сервер для Логирования и Управления Пользователями

## Описание

Этот скрипт запускает простой веб-сервер на Python, предоставляющий следующие возможности:

1.  **Логирование данных (`/upload`)**: Принимает GET-запросы на `/upload` с параметрами `key`, `login`, `password`. Если переданный `key` совпадает с ключом из файла конфигурации, пара `login:password` записывается в конец указанного файла логов.
2.  **Управление пользователями (`/users`)**: Отображает список пользователей из указанного текстового файла. Доступ к этой странице защищен базовой HTTP-аутентификацией (логин/пароль из файла конфигурации). Позволяет удалять пользователей через веб-интерфейс с подтверждением.
3.  **Конфигурация**: Ключ API и учетные данные администратора загружаются из файла `config.ini`.
4.  **Интерфейс**: Страница `/users` использует Bootstrap 5.2 для более приятного отображения таблицы.

## Функционал

* Запуск HTTP-сервера на указанном хосте и порту.
* Защищенная запись данных через эндпоинт `/upload` по API-ключу.
* Отображение списка пользователей из файла на странице `/users`.
* Базовая HTTP-аутентификация для доступа к `/users`.
* Определение формата Bitcoin-адреса (Legacy, P2SH, Bech32, Bech32m).
* Удаление пользователей через веб-интерфейс с подтверждением.
* Загрузка чувствительных данных (API-ключ, логин/пароль админа) из `config.ini`.
* Использование Bootstrap 5.2 для стилизации таблицы пользователей.
* Обработка двоеточий в паролях пользователей при парсинге.
* Простая блокировка файла для предотвращения конфликтов при одновременном удалении (не гарантирует 100% защиты).

## Требования

* Python 3.x
* Стандартные библиотеки Python (внешние зависимости не требуются).

## Настройка

1.  **Файл конфигурации (`config.ini`)**:
    * Создайте файл `config.ini` в той же директории, что и скрипт (`main.py`).
    * Добавьте в него следующее содержимое, заменив значения на ваши:

        ```ini
        [API]
        # Секретный ключ для доступа к эндпоинту /upload
        secret_key = YOUR_VERY_SECRET_API_KEY_HERE

        [Admin]
        # Логин и пароль для доступа к странице /users
        username = admin
        password = your_strong_admin_password
        ```
    * **ВАЖНО:** Храните `secret_key` и `password` в секрете! Установите правильные права доступа к файлу `config.ini`, чтобы его не могли прочитать посторонние.

2.  **Файл пользователей (`users.txt`)**:
    * Создайте текстовый файл (например, `users.txt`) в кодировке UTF-8.
    * Каждая строка должна содержать данные одного пользователя **строго в 8 полях**, разделенных двоеточием (`:`):
        `Username:Password:Address:City:Average:Last Buy:Dispute:Balance`
    * Даже если какое-то поле пустое, оно должно присутствовать (например, `::` для пустого поля между двумя другими).
    * Пароль (`Password`) может содержать двоеточия.
    * *Пример строки:*
        `krevetka9111:zyfto2:sIqcah:rommym:bc1qpzz5xeppk0hl9zhqvmjnlux6akujpecpl9454l:City Москва:Average 0 рублей:Last Buy :Dispute 0:Balance {0 RUB}`

3.  **Файл логов (`output.txt`)**:
    * Создайте пустой текстовый файл (например, `output.txt`) или укажите имя при запуске. Скрипт будет дописывать в него данные формата `login:password` при успешных запросах к `/upload`. Если файл не существует при запуске, скрипт попытается его создать.

## Запуск сервера

Выполните команду в терминале:

```bash
python3 main.py <output_file> <users_file> [--config <config_file>] [--host <host_ip>] [--port <port_number>]
<output_file>: Путь к файлу, куда будут записываться данные из /upload (например, output.txt). Обязательный.<users_file>: Путь к файлу с данными пользователей для /users (например, users.txt). Обязательный.--config <config_file>: Путь к файлу конфигурации (по умолчанию: config.ini). Необязательный.--host <host_ip>: IP-адрес, на котором будет слушать сервер (по умолчанию: 0.0.0.0 - все интерфейсы). Необязательный.--port <port_number>: Порт, на котором будет слушать сервер (по умолчанию: 8000). Необязательный.Пример запуска:python3 main.py output.txt users.txt --host 0.0.0.0 --port 8080
Использование/upload: Отправьте GET-запрос на http://<host>:<port>/upload?key=YOUR_API_KEY&login=some_user&password=some_password. При успехе данные some_user:some_password будут добавлены в <output_file>./users: Откройте в браузере http://<host>:<port>/users. Появится запрос на ввод имени пользователя и пароля (используйте данные из секции [Admin] файла config.ini). После успешной аутентификации отобразится таблица пользователей. Вы можете нажать кнопку "Удалить" в строке пользователя, чтобы удалить его (потребуется подтверждение).Краткая инструкция по запускуУстановите Python 3.Создайте файл config.ini с секциями [API] (ключ secret_key) и [Admin] (ключи username, password). Заполните своими данными.Создайте файл users.txt (или другое имя) в кодировке UTF-8. Заполните данными пользователей в формате Username:Password:Address:City:Average:Last Buy:Dispute:Balance (8 полей через :).Создайте пустой файл output.txt (или другое имя) для логов /upload.Запустите сервер командой:python3 main.py output.txt users.txt --port 8080
(замените имена файлов и порт при необходимости).Откройте /users в браузере и введите логин/пароль администратора.Отправляйте GET-запросы на /upload для записи данных.Замечания по безопасностиHTTP Basic Authentication небезопасна по HTTP! Логин и пароль передаются почти в открытом виде (легко декодируемая Base64). Используйте этот сервер только в доверенной локальной сети или настройте HTTPS (что выходит за рамки этого скрипта).Секретный ключ API (secret_key) должен быть сложным и храниться в секрете.Права доступа к файлам: Убедитесь, что у файла config.ini нет прав на чтение для посторонних, а у скрипта есть права на чтение config.ini и users.txt, а также на запись в output.txt и users.txt (для удаления).Блокировка файла: Реализована очень простая блокировка файла
